# My-Pho-App 완전 사용 시나리오 - Part 3: 관리자 대시보드

## 🖥️ 관리자 대시보드 전체 시나리오

---

### 시나리오 4: 관리자 로그인 및 대시보드 개요

#### 4-1. 관리자 로그인

**접근 방법**:
- URL: `https://daebak.myplatform.com/admin`
- 또는 고객 앱에서 관리자 권한이 있는 계정 로그인 시 "관리자 모드" 버튼 표시

**Admin Login 화면**:
```
┌─────────────────────────────────────────┐
│                                         │
│         🍜 대박마라탕                     │
│         관리자 시스템                     │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ 📧 관리자 이메일                     │ │
│ │ admin@daebak.com                    │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ 🔒 비밀번호                          │ │
│ │ ••••••••                            │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ☑ 로그인 상태 유지                       │
│                                         │
│ [        관리자 로그인       ]          │
│                                         │
└─────────────────────────────────────────┘
```

**로그인 성공 시**:
- Firebase Authentication 검증
- Firestore에서 관리자 권한 확인:
  ```javascript
  users/{userId}: {
    isAdmin: true,
    adminRole: "owner" // or "manager", "staff"
  }
  ```
- AdminLayout으로 리다이렉트

---

#### 4-2. 관리자 대시보드 메인 (Dashboard)

**AdminLayout 구조**:
```
┌──────────────────────────────────────────────────────────┐
│ 🍜 대박마라탕 관리자          [🔔 알림 3] [👤 관리자님▼] │ 헤더
├──────┬──────────────────────────────────────────────────┤
│      │                                                  │
│ 📊   │  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐               │
│ 대시  │  │오늘 │ │미처리│ │신규 │ │평균 │               │
│ 보드  │  │매출 │ │주문 │ │고객 │ │평점 │  KPI 카드     │
│      │  │     │ │     │ │     │ │     │               │
│ 📦   │  └─────┘ └─────┘ └─────┘ └─────┘               │
│ 주문  │                                                  │
│ 관리  │  ━━━━━━━━━━━━━━━━━━━━━                         │
│      │                                                  │
│ 🍽️   │  💰 매출 현황 (최근 7일)                         │
│ 메뉴  │  ┌────────────────────────────────────────┐    │
│ 관리  │  │ 📈 [차트 영역]                          │    │
│      │  │                                        │    │
│ ⭐   │  │    매출 추이 그래프                     │    │
│ 리뷰  │  │                                        │    │
│ 관리  │  └────────────────────────────────────────┘    │
│      │                                                  │
│ 🎁   │  ━━━━━━━━━━━━━━━━━━━━━                         │
│ 프로  │                                                  │
│ 모션  │  📋 최근 주문 (실시간)                          │
│      │  ┌────────────────────────────────────────┐    │
│ 📈   │  │ #001 소고기마라탕 x1  14:05  [접수대기] │    │
│ 분석  │  │ #002 해물마라탕 x2    14:10  [조리중]  │    │
│      │  │ #003 꿔바로우 x1      14:12  [배달중]  │    │
│ ⚙️   │  └────────────────────────────────────────┘    │
│ 설정  │                                                  │
│      │  [전체 주문 보기 >]                              │
└──────┴──────────────────────────────────────────────────┘
```

**KPI 카드 상세**:

```
┌────────────────────┐
│ 💰 오늘 매출        │
│                    │
│   ₩1,234,000      │ 굵게, 큰 글씨
│   ▲ 15% vs 어제   │ 녹색, 증가 표시
└────────────────────┘

┌────────────────────┐
│ 📦 미처리 주문      │
│                    │
│        5건         │ 빨간색 (긴급)
│   가장 오래된:     │
│   10분 전         │ 작은 글씨
└────────────────────┘

┌────────────────────┐
│ 👥 신규 고객        │
│                    │
│       12명         │
│   ▲ 3명 vs 어제    │
└────────────────────┘

┌────────────────────┐
│ ⭐ 평균 평점        │
│                    │
│      4.8/5.0      │
│   ⭐⭐⭐⭐⭐       │
│   (총 128개 리뷰)  │
└────────────────────┘
```

**실시간 데이터 업데이트**:
- Firestore 실시간 리스너로 주문, 매출 데이터 갱신
- 새 주문 도착 시:
  - 🔔 알림 아이콘 배지 증가
  - 사운드 알림 (띠링~ ♪)
  - 최근 주문 리스트 상단에 새 항목 추가 (페이드인 애니메이션)
  - 미처리 주문 카운트 증가

---

### 시나리오 5: 주문 관리 (Orders)

#### 5-1. 주문 목록 페이지

**사용자 액션**: 좌측 메뉴 [📦 주문 관리] 클릭

**Orders 화면**:
```
┌──────────────────────────────────────────────────────────┐
│ 주문 관리                           [🔄 새로고침] [⚙️]   │
├──────────────────────────────────────────────────────────┤
│ [접수대기 5] [조리중 3] [배달중 2] [완료] [취소/환불]     │ 탭
├──────────────────────────────────────────────────────────┤
│ 🔍 주문번호, 고객명, 전화번호 검색...                     │
├──────────────────────────────────────────────────────────┤
│                                                          │
│ ┌────────────────────────────────────────────────────┐  │
│ │ #20251206001                    14:05 접수   [강남구]│  │
│ │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │  │
│ │                                                    │  │
│ │ 👤 김철수 (010-1234-5678)                         │  │
│ │ 📍 서울시 강남구 테헤란로 123 101동 1001호         │  │
│ │ 💬 초인종 눌러주세요                               │  │
│ │                                                    │  │
│ │ 📋 주문 내역:                                      │  │
│ │ • 소고기 마라탕 x 1 (보통맛, 새우추가)  ₩14,000   │  │
│ │                                                    │  │
│ │ 💳 결제: 카드 ₩14,000 (결제완료)                  │  │
│ │                                                    │  │
│ │ [거부] [접수하기]                                  │  │
│ │                                                    │  │
│ │ ⏱️ 10분 전                                         │  │
│ └────────────────────────────────────────────────────┘  │
│                                                          │
│ ┌────────────────────────────────────────────────────┐  │
│ │ #20251206002                    14:10 조리중   🔥   │  │
│ │ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │  │
│ │                                                    │  │
│ │ 👤 이영희 (010-9876-5432)                         │  │
│ │ 📍 서울시 서초구 서초대로 456                      │  │
│ │                                                    │  │
│ │ 📋 주문 내역:                                      │  │
│ │ • 해물 마라탕 x 2              ₩22,000           │  │
│ │ • 꿔바로우 x 1                  ₩8,000           │  │
│ │                                                    │  │
│ │ 💳 결제: 만나서 결제(카드) ₩30,000                │  │
│ │                                                    │  │
│ │ [조리 완료] [상세보기]                             │  │
│ │                                                    │  │
│ │ ⏱️ 5분 전 | 조리 시작: 14:12                       │  │
│ └────────────────────────────────────────────────────┘  │
│                                                          │
│ [더 보기...]                                             │
└──────────────────────────────────────────────────────────┘
```

**상태별 색상 코딩**:
- 접수대기: 빨간색 배지 `⏱️` (긴급)
- 조리중: 주황색 `🔥`
- 배달중: 파란색 `🚚`
- 완료: 녹색 `✅`
- 취소: 회색 `❌`

---

#### 5-2. 주문 접수 프로세스

**사용자 액션**: 첫 번째 주문의 [접수하기] 버튼 클릭

**확인 모달**:
```
┌────────────────────────────────────────┐
│ 주문 접수 확인                          │
├────────────────────────────────────────┤
│                                        │
│ 주문번호: #20251206001                 │
│ 고객명: 김철수                          │
│                                        │
│ 예상 조리 시간 설정                     │
│ ┌─────┐                               │
│ │ 30  │ 분                            │ 입력 필드
│ └─────┘                               │
│                                        │
│ [추천: 30-40분]                        │ 도움말
│                                        │
│ [취소]              [접수하기]         │
└────────────────────────────────────────┘
```

**관리자 입력**: 예상 시간 `35분` 입력

**사용자 액션**: [접수하기] 버튼 클릭

**시스템 처리**:

1. **Firestore 업데이트**:
   ```javascript
   orders/{orderId}: {
     status: "confirmed",
     confirmedAt: Timestamp,
     confirmedBy: adminUserId,
     estimatedTime: 35,
     estimatedDeliveryTime: Timestamp(now + 35분)
   }
   ```

2. **고객 알림 발송**:
   - 푸시 알림:
     ```
     🍜 주문이 접수되었습니다!
     예상 도착: 약 35분 후
     ```
   - 고객 앱의 OrderTracking 페이지 실시간 업데이트

3. **UI 업데이트**:
   - 해당 주문 카드가 "접수대기" 탭에서 사라짐
   - "조리중" 탭으로 이동 (애니메이션)
   - 탭 카운트 업데이트: `[접수대기 5]` → `[접수대기 4]`, `[조리중 3]` → `[조리중 4]`
   - 성공 토스트: `✅ 주문이 접수되었습니다`

4. **프린터 출력** (선택):
   - 주문서 자동 출력 (설정 시)
   - 주문 번호, 시간, 고객 정보, 메뉴 내역

---

#### 5-3. 주문 상태 변경

**상황**: 조리 완료

**사용자 액션**: #20251206002 주문의 [조리 완료] 버튼 클릭

**상태 변경 옵션 모달**:
```
┌────────────────────────────────────────┐
│ 주문 상태 변경                          │
├────────────────────────────────────────┤
│                                        │
│ #20251206002 - 이영희                  │
│                                        │
│ 다음 단계 선택:                         │
│ ● 배달 시작                            │ 라디오 버튼
│ ○ 픽업 준비 완료                        │
│                                        │
│ 배달 직원 배정 (선택):                  │
│ ┌──────────────────────────────────┐  │
│ │ 김배달 (010-1111-2222)           │  │ 드롭다운
│ └──────────────────────────────────┘  │
│                                        │
│ [취소]              [확인]             │
└────────────────────────────────────────┘
```

**사용자 선택**: 
- "배달 시작" 선택
- 배달 직원: "김배달" 선택

**사용자 액션**: [확인] 클릭

**시스템 처리**:

1. **Firestore 업데이트**:
   ```javascript
   orders/{orderId}: {
     status: "delivering",
     deliveryStartedAt: Timestamp,
     deliveryPerson: {
       name: "김배달",
       phone: "010-1111-2222"
     }
   }
   ```

2. **고객 알림**:
   ```
   🚚 배달이 시작되었습니다!
   배달 기사: 김배달
   곧 도착할 예정입니다.
   ```

3. **배달원 알림** (별도 시스템):
   ```
   📦 새 배달 요청
   대박마라탕 → 서울시 서초구 서초대로 456
   [수락] [거부]
   ```

4. **UI 업데이트**:
   - 주문이 "조리중" → "배달중" 탭으로 이동
   - 실시간 위치 추적 표시 (옵션)

---

#### 5-4. 주문 상세 보기

**사용자 액션**: 주문 카드 클릭 또는 [상세보기] 버튼

**주문 상세 모달** (큰 모달 또는 새 페이지):
```
┌──────────────────────────────────────────────────────────┐
│ ← 뒤로               주문 상세             [인쇄] [더보기▼]│
├──────────────────────────────────────────────────────────┤
│                                                          │
│ 주문번호: #20251206001                        [접수대기]  │
│ 주문 시각: 2025.12.06 14:05                              │
│ 예상 도착: 14:40 (35분)                                  │
│                                                          │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━│
│                                                          │
│ 👤 고객 정보                                             │
│ ┌────────────────────────────────────────────────────┐  │
│ │ 이름: 김철수                                        │  │
│ │ 전화: 010-1234-5678              [📞 전화걸기]      │  │
│ │ 가입일: 2025.12.06 (신규 고객! 🎉)                 │  │
│ │ 총 주문: 1회                                       │  │
│ │ 누적 금액: ₩14,000                                 │  │
│ └────────────────────────────────────────────────────┘  │
│                                                          │
│ 📍 배달 정보                                             │
│ ┌────────────────────────────────────────────────────┐  │
│ │ 주소: 서울시 강남구 테헤란로 123 101동 1001호       │  │
│ │                              [🗺️ 지도 보기]         │  │
│ │                                                    │  │
│ │ 요청사항: 초인종 눌러주세요                         │  │
│ │                                                    │  │
│ │ 거리: 약 2.3km (예상 배달시간 15분)                │  │
│ └────────────────────────────────────────────────────┘  │
│                                                          │
│ 📋 주문 내역                                             │
│ ┌────────────────────────────────────────────────────┐  │
│ │ • 소고기 마라탕                          ₩12,000   │  │
│ │   수량: 1                                          │  │
│ │   옵션: 보통맛, 1인분                              │  │
│ │   추가: 새우 추가 (+₩2,000)                        │  │
│ │                                                    │  │
│ │ 주문 금액:                              ₩14,000   │  │
│ │ 배달팁:                                  ₩3,000   │  │
│ │ 쿠폰 할인(첫 주문 3,000원):             -₩3,000   │  │
│ │ ─────────────────────────────────────────────────  │  │
│ │ 총 결제 금액:                           ₩14,000   │  │
│ └────────────────────────────────────────────────────┘  │
│                                                          │
│ 💳 결제 정보                                             │
│ ┌────────────────────────────────────────────────────┐  │
│ │ 결제 수단: 신용카드 (****3456)                      │  │
│ │ 결제 상태: ✅ 승인 완료                             │  │
│ │ 승인 번호: 12345678                                │  │
│ │ 승인 시각: 14:05:23                                │  │
│ │                                                    │  │
│ │ [영수증 발행] [환불 처리]                           │  │
│ └────────────────────────────────────────────────────┘  │
│                                                          │
│ 📝 주문 히스토리                                         │
│ ┌────────────────────────────────────────────────────┐  │
│ │ 14:05:12 - 주문 접수 (온라인)                      │  │
│ │ 14:05:23 - 결제 승인 완료                          │  │
│ │ 14:06:45 - 관리자 확인 대기 중...                  │  │
│ └────────────────────────────────────────────────────┘  │
│                                                          │
│ ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━│
│                                                          │
│ [주문 거부]  [주문 접수]  [메모 추가]  [고객에게 메시지]  │
└──────────────────────────────────────────────────────────┘
```

**인터랙션**: [메모 추가] 버튼 클릭

**메모 입력 모달**:
```
┌────────────────────────────────────────┐
│ 주문 메모 추가                          │
├────────────────────────────────────────┤
│ ┌──────────────────────────────────┐  │
│ │                                  │  │
│ │ 소고기 신선한 것으로 사용        │  │
│ │ 새우 2개 더 추가함               │  │
│ │                                  │  │
│ └──────────────────────────────────┘  │
│                                        │
│ [취소]              [저장]             │
└────────────────────────────────────────┘
```

**저장 시**:
- Firestore 업데이트:
  ```javascript
  orders/{orderId}: {
    adminNotes: [{
      note: "소고기 신선한 것으로...",
      addedBy: adminId,
      addedAt: Timestamp
    }]
  }
  ```
- 메모 섹션에 표시

---

#### 5-5. 주문 거부 처리

**사용자 액션**: [주문 거부] 버튼 클릭

**거부 사유 선택 모달**:
```
┌────────────────────────────────────────┐
│ 주문 거부                               │
├────────────────────────────────────────┤
│ 거부 사유를 선택하세요:                  │
│                                        │
│ ○ 재료 소진                            │
│ ○ 배달 불가 지역                        │
│ ○ 영업 시간 외                          │
│ ○ 주문 폭주로 처리 불가                  │
│ ● 기타                                 │
│                                        │
│ 상세 사유 (고객에게 전달됩니다):         │
│ ┌──────────────────────────────────┐  │
│ │ 죄송합니다. 오늘 소고기 재고가    │  │
│ │ 소진되어 주문을 받을 수 없습니다. │  │
│ │ 다음에 더 좋은 서비스로          │  │
│ │ 보답하겠습니다.                  │  │
│ └──────────────────────────────────┘  │
│                                        │
│ ⚠️ 주의: 결제가 자동으로 취소됩니다     │
│                                        │
│ [취소]              [거부하기]         │
└────────────────────────────────────────┘
```

**사용자 액션**: [거부하기] 클릭

**시스템 처리**:

1. **Firestore 업데이트**:
   ```javascript
   orders/{orderId}: {
     status: "rejected",
     rejectedAt: Timestamp,
     rejectedBy: adminId,
     rejectionReason: "기타",
     rejectionMessage: "죄송합니다. 오늘..."
   }
   ```

2. **결제 취소 프로세스**:
   - NICEPAY API 호출 (자동 환불)
   - 결제 상태 업데이트: `approved` → `refunded`

3. **고객 알림**:
   - 푸시: `❌ 주문이 취소되었습니다`
   - 앱 내 알림 + 이메일/SMS:
     ```
     주문번호 #20251206001이 취소되었습니다.
     
     사유: 죄송합니다. 오늘 소고기 재고가...
     
     결제 금액 ₩14,000이 자동으로 환불됩니다.
     환불은 2-3 영업일 내 완료됩니다.
     ```

4. **UI 업데이트**:
   - 주문이 "취소/환불" 탭으로 이동
   - 접수대기 카운트 감소

---

계속해서 메뉴 관리, 리뷰 관리, 프로모션 관리 등 나머지 관리자 기능들의 상세 시나리오를 작성하겠습니다...
